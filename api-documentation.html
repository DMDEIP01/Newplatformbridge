<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        h1 {
            color: #2c3e50;
            border-bottom: 4px solid #3498db;
            padding-bottom: 15px;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        h2 {
            color: #34495e;
            margin-top: 50px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
            font-size: 1.8em;
        }

        h3 {
            color: #7f8c8d;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        h4 {
            color: #95a5a6;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .endpoint {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .endpoint-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .method {
            padding: 6px 12px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.9em;
            font-family: 'Courier New', monospace;
        }

        .method-post { background: #28a745; color: white; }
        .method-get { background: #17a2b8; color: white; }
        .method-put { background: #ffc107; color: #333; }
        .method-delete { background: #dc3545; color: white; }

        .endpoint-path {
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            color: #495057;
            flex-grow: 1;
        }

        .auth-badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .auth-required { background: #e74c3c; color: white; }
        .auth-optional { background: #f39c12; color: white; }
        .auth-none { background: #2ecc71; color: white; }

        .section {
            margin-bottom: 30px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.9em;
        }

        th {
            background: #3498db;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 10px 12px;
            border-bottom: 1px solid #ecf0f1;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #e74c3c;
        }

        pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            line-height: 1.5;
        }

        .info-box {
            background: #e8f4f8;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 15px 0;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
        }

        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
        }

        .metadata {
            color: #7f8c8d;
            font-size: 0.9em;
            margin-bottom: 30px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .toc {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .toc h3 {
            margin-top: 0;
        }

        .toc ul {
            list-style: none;
            margin-left: 0;
        }

        .toc a {
            color: #3498db;
            text-decoration: none;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        .response-code {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 0.9em;
        }

        .code-200 { background: #d4edda; color: #155724; }
        .code-201 { background: #d4edda; color: #155724; }
        .code-400 { background: #f8d7da; color: #721c24; }
        .code-401 { background: #f8d7da; color: #721c24; }
        .code-403 { background: #f8d7da; color: #721c24; }
        .code-404 { background: #f8d7da; color: #721c24; }
        .code-500 { background: #f8d7da; color: #721c24; }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
                padding: 20px;
            }

            .endpoint {
                page-break-inside: avoid;
            }

            h2 {
                page-break-before: always;
            }

            h2:first-of-type {
                page-break-before: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>API Documentation</h1>
        
        <div class="metadata">
            <strong>Project:</strong> Insurance/Warranty Management Platform<br>
            <strong>Base URL:</strong> https://ynphvrkktapgghzxjakp.supabase.co/functions/v1<br>
            <strong>Generated:</strong> December 11, 2024<br>
            <strong>Authentication:</strong> JWT Bearer Token<br>
            <strong>Edge Functions:</strong> 24 serverless functions
        </div>

        <div class="toc">
            <h3>API Index</h3>
            <ul>
                <li><a href="#overview">1. API Overview</a></li>
                <li><a href="#authentication">2. Authentication</a></li>
                <li><a href="#user-management">3. User Management APIs</a></li>
                <li><a href="#ai-analysis">4. AI Analysis APIs</a></li>
                <li><a href="#communication">5. Communication APIs</a></li>
                <li><a href="#utilities">6. Utility APIs</a></li>
                <li><a href="#data-seeding">7. Data Seeding APIs</a></li>
                <li><a href="#error-codes">8. Error Codes</a></li>
            </ul>
        </div>

        <div id="overview" class="section">
            <h2>1. API Overview</h2>
            
            <div class="info-box">
                <h4>Base Information</h4>
                <ul>
                    <li><strong>Protocol:</strong> HTTPS only</li>
                    <li><strong>Format:</strong> JSON (Content-Type: application/json)</li>
                    <li><strong>Authentication:</strong> Bearer Token (JWT)</li>
                    <li><strong>Rate Limiting:</strong> Per Supabase project tier</li>
                    <li><strong>CORS:</strong> Enabled for all origins</li>
                </ul>
            </div>

            <h3>Common Headers</h3>
            <table>
                <thead>
                    <tr>
                        <th>Header</th>
                        <th>Required</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>Authorization</code></td>
                        <td>Yes (most endpoints)</td>
                        <td>Bearer JWT token from Supabase Auth</td>
                    </tr>
                    <tr>
                        <td><code>Content-Type</code></td>
                        <td>Yes</td>
                        <td>application/json</td>
                    </tr>
                    <tr>
                        <td><code>apikey</code></td>
                        <td>Yes</td>
                        <td>Supabase anonymous key</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div id="authentication" class="section">
            <h2>2. Authentication</h2>
            
            <div class="warning-box">
                <strong>Important:</strong> All API requests (except where noted) require a valid JWT token obtained from Supabase Auth.
            </div>

            <h3>Obtaining JWT Token</h3>
            <pre>// Using Supabase Client
import { supabase } from '@/integrations/supabase/client'

const { data, error } = await supabase.auth.signInWithPassword({
  email: 'user@example.com',
  password: 'password123'
})

// Use data.session.access_token for API calls</pre>

            <h3>Using JWT Token</h3>
            <pre>// Example API Request
const response = await fetch(
  'https://ynphvrkktapgghzxjakp.supabase.co/functions/v1/endpoint-name',
  {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${access_token}`,
      'Content-Type': 'application/json',
      'apikey': 'your-supabase-anon-key'
    },
    body: JSON.stringify({ /* request body */ })
  }
)</pre>
        </div>

        <div id="user-management" class="section">
            <h2>3. User Management APIs</h2>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/manage-user</span>
                    <span class="auth-badge auth-required">Auth Required</span>
                </div>
                
                <h4>Description</h4>
                <p>Create, update, or manage user accounts and roles. Used by system administrators.</p>
                
                <h4>Required Roles</h4>
                <p><code>system_admin</code></p>
                
                <h4>Request Body</h4>
                <pre>{
  "action": "create" | "update" | "delete",
  "email": "user@example.com",
  "password": "securePassword123",
  "fullName": "John Doe",
  "role": "retail_agent",
  "programId": "uuid-optional"
}</pre>

                <h4>Response</h4>
                <div class="success-box">
                    <span class="response-code code-200">200 OK</span>
                    <pre>{
  "success": true,
  "userId": "uuid",
  "message": "User created successfully"
}</pre>
                </div>

                <h4>Possible Errors</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Status</th>
                            <th>Message</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="response-code code-401">401</span></td>
                            <td>Unauthorized</td>
                            <td>Missing or invalid JWT token</td>
                        </tr>
                        <tr>
                            <td><span class="response-code code-403">403</span></td>
                            <td>Forbidden</td>
                            <td>User lacks system_admin role</td>
                        </tr>
                        <tr>
                            <td><span class="response-code code-400">400</span></td>
                            <td>User already exists</td>
                            <td>Email already registered</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/grant-consultant</span>
                    <span class="auth-badge auth-required">Auth Required</span>
                </div>
                
                <h4>Description</h4>
                <p>Grant the consultant role to an authenticated user.</p>
                
                <h4>Required Roles</h4>
                <p><code>admin</code> or <code>system_admin</code></p>
                
                <h4>Request Body</h4>
                <p>No body required. Uses authenticated user ID from JWT.</p>

                <h4>Response</h4>
                <div class="success-box">
                    <span class="response-code code-200">200 OK</span>
                    <pre>{
  "success": true,
  "message": "Consultant role granted"
}</pre>
                </div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/grant-role</span>
                    <span class="auth-badge auth-required">Auth Required</span>
                </div>
                
                <h4>Description</h4>
                <p>Generic role assignment with optional user creation. Can assign any role to new or existing users.</p>
                
                <h4>Required Roles</h4>
                <p><code>admin</code> or <code>system_admin</code></p>
                
                <h4>Request Body</h4>
                <pre>{
  "email": "newuser@example.com",
  "password": "password123",
  "fullName": "Jane Smith",
  "role": "claims_agent",
  "programId": "uuid-optional"
}</pre>

                <h4>Headers (Optional)</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Header</th>
                            <th>Value</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>x-exclusive</code></td>
                            <td>true</td>
                            <td>If true, removes existing roles before assigning new one</td>
                        </tr>
                    </tbody>
                </table>

                <h4>Response</h4>
                <div class="success-box">
                    <span class="response-code code-201">201 Created</span>
                    <pre>{
  "success": true,
  "userId": "uuid",
  "role": "claims_agent",
  "message": "Role granted successfully"
}</pre>
                </div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/grant-system-admin</span>
                    <span class="auth-badge auth-required">Auth Required</span>
                </div>
                
                <h4>Description</h4>
                <p>Grant the system_admin role to the authenticated user. Typically used during initial setup.</p>
                
                <h4>Required Roles</h4>
                <p>Authenticated user (self-service during setup)</p>
                
                <h4>Request Body</h4>
                <p>No body required. Uses authenticated user ID from JWT.</p>

                <h4>Response</h4>
                <div class="success-box">
                    <span class="response-code code-200">200 OK</span>
                    <pre>{
  "success": true,
  "message": "System admin role granted"
}</pre>
                </div>

                <div class="warning-box">
                    <strong>Security Note:</strong> This endpoint checks if the user already has the system_admin role before granting it to prevent duplicate entries.
                </div>
            </div>
        </div>

        <div id="ai-analysis" class="section">
            <h2>4. AI Analysis APIs</h2>

            <div class="info-box">
                <strong>AI Models Used:</strong>
                <ul>
                    <li><strong>Gemini 2.5 Flash:</strong> Fast image and document analysis</li>
                    <li><strong>Gemini 2.5 Pro:</strong> Complex reasoning and recommendations</li>
                    <li><strong>GPT-5 Mini:</strong> Conversational AI and text processing</li>
                </ul>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/analyze-damage</span>
                    <span class="auth-badge auth-required">Auth Required</span>
                </div>
                
                <h4>Description</h4>
                <p>AI-powered damage assessment from uploaded photos. Analyzes severity, type, and repairability.</p>
                
                <h4>Required Roles</h4>
                <p><code>retail_agent</code>, <code>claims_agent</code>, or <code>admin</code></p>
                
                <h4>Request Body</h4>
                <pre>{
  "imageUrl": "https://storage.url/path/to/damage-photo.jpg",
  "deviceType": "smartphone",
  "claimType": "accidental_damage"
}</pre>

                <h4>Response</h4>
                <div class="success-box">
                    <span class="response-code code-200">200 OK</span>
                    <pre>{
  "success": true,
  "analysis": {
    "damageType": "screen_crack",
    "severity": "moderate",
    "repairable": true,
    "estimatedCost": 150.00,
    "confidence": 0.92,
    "description": "Screen has multiple cracks radiating from impact point...",
    "recommendations": [
      "Screen replacement required",
      "Check LCD functionality"
    ]
  }
}</pre>
                </div>

                <h4>AI Model</h4>
                <p>Gemini 2.5 Flash (multimodal image analysis)</p>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/analyze-device</span>
                    <span class="auth-badge auth-required">Auth Required</span>
                </div>
                
                <h4>Description</h4>
                <p>AI-powered device identification and condition assessment from photos.</p>
                
                <h4>Required Roles</h4>
                <p><code>retail_agent</code>, <code>claims_agent</code>, or <code>admin</code></p>
                
                <h4>Request Body</h4>
                <pre>{
  "imageUrl": "https://storage.url/path/to/device-photo.jpg",
  "expectedManufacturer": "Apple",
  "expectedModel": "iPhone 15 Pro"
}</pre>

                <h4>Response</h4>
                <div class="success-box">
                    <span class="response-code code-200">200 OK</span>
                    <pre>{
  "success": true,
  "analysis": {
    "manufacturer": "Apple",
    "model": "iPhone 15 Pro",
    "condition": "good",
    "authenticity": "genuine",
    "confidence": 0.95,
    "visibleDamage": false,
    "notes": "Device appears to be in good condition with minimal wear"
  }
}</pre>
                </div>

                <h4>AI Model</h4>
                <p>Gemini 2.5 Flash (image recognition and classification)</p>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/analyze-receipt</span>
                    <span class="auth-badge auth-required">Auth Required</span>
                </div>
                
                <h4>Description</h4>
                <p>OCR and intelligent analysis of purchase receipts to extract key information.</p>
                
                <h4>Required Roles</h4>
                <p><code>retail_agent</code>, <code>claims_agent</code>, or <code>admin</code></p>
                
                <h4>Request Body</h4>
                <pre>{
  "imageUrl": "https://storage.url/path/to/receipt.jpg",
  "expectedAmount": 999.99,
  "expectedDate": "2025-01-15"
}</pre>

                <h4>Response</h4>
                <div class="success-box">
                    <span class="response-code code-200">200 OK</span>
                    <pre>{
  "success": true,
  "analysis": {
    "storeName": "MediaMarkt",
    "storeLocation": "Berlin, Germany",
    "purchaseDate": "2025-01-15",
    "totalAmount": 999.99,
    "currency": "EUR",
    "items": [
      {
        "description": "iPhone 15 Pro 256GB",
        "quantity": 1,
        "price": 999.99
      }
    ],
    "paymentMethod": "Credit Card",
    "valid": true,
    "confidence": 0.88
  }
}</pre>
                </div>

                <h4>AI Model</h4>
                <p>Gemini 2.5 Flash (OCR and document understanding)</p>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/claims-fulfillment-advisor</span>
                    <span class="auth-badge auth-required">Auth Required</span>
                </div>
                
                <h4>Description</h4>
                <p>AI-powered recommendations for claim fulfillment strategy based on damage analysis, policy terms, and cost optimization.</p>
                
                <h4>Required Roles</h4>
                <p><code>claims_agent</code> or <code>admin</code></p>
                
                <h4>Request Body</h4>
                <pre>{
  "claimId": "uuid",
  "damageAnalysis": { /* damage analysis object */ },
  "deviceValue": 999.99,
  "excessAmount": 50.00,
  "policyTerms": { /* policy parameters */ }
}</pre>

                <h4>Response</h4>
                <div class="success-box">
                    <span class="response-code code-200">200 OK</span>
                    <pre>{
  "success": true,
  "recommendation": {
    "fulfillmentType": "repair",
    "reasoning": "Cost-effective repair available. Device value supports repair...",
    "estimatedCost": 150.00,
    "alternatives": [
      {
        "type": "replace",
        "cost": 999.99,
        "notes": "Full replacement if repair fails"
      },
      {
        "type": "voucher",
        "amount": 800.00,
        "notes": "BER scenario if repair exceeds 80% of device value"
      }
    ],
    "suggestedRepairer": {
      "id": "uuid",
      "name": "TechFix Solutions",
      "capabilities": ["screen_repair", "battery_replacement"]
    }
  }
}</pre>
                </div>

                <h4>AI Model</h4>
                <p>Gemini 2.5 Pro (complex reasoning and decision support)</p>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/service-agent</span>
                    <span class="auth-badge auth-required">Auth Required</span>
                </div>
                
                <h4>Description</h4>
                <p>AI chatbot for customer service requests. Provides automated responses and escalates to human agents when needed.</p>
                
                <h4>Required Roles</h4>
                <p>Any authenticated user</p>
                
                <h4>Request Body</h4>
                <pre>{
  "serviceRequestId": "uuid",
  "message": "How do I check my policy coverage?",
  "conversationHistory": [
    {
      "role": "user",
      "content": "Previous message..."
    },
    {
      "role": "assistant",
      "content": "Previous response..."
    }
  ]
}</pre>

                <h4>Response</h4>
                <div class="success-box">
                    <span class="response-code code-200">200 OK</span>
                    <pre>{
  "success": true,
  "response": {
    "message": "To check your policy coverage, you can...",
    "requiresHumanAgent": false,
    "confidence": 0.87,
    "suggestedActions": [
      "View policy documents",
      "Contact claims team"
    ]
  }
}</pre>
                </div>

                <h4>AI Model</h4>
                <p>GPT-5 Mini (conversational AI)</p>
            </div>
        </div>

        <div id="communication" class="section">
            <h2>5. Communication APIs</h2>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/send-templated-email</span>
                    <span class="auth-badge auth-required">Auth Required</span>
                </div>
                
                <h4>Description</h4>
                <p>Send templated emails for policy communications, claim updates, etc. Uses SendGrid or Resend.</p>
                
                <h4>Required Roles</h4>
                <p><code>retail_agent</code>, <code>claims_agent</code>, or <code>admin</code></p>
                
                <h4>Request Body</h4>
                <pre>{
  "to": "customer@example.com",
  "subject": "Policy Welcome",
  "htmlContent": "&lt;html&gt;...&lt;/html&gt;",
  "policyId": "uuid-optional",
  "claimId": "uuid-optional"
}</pre>

                <h4>Response</h4>
                <div class="success-box">
                    <span class="response-code code-200">200 OK</span>
                    <pre>{
  "success": true,
  "messageId": "sendgrid-message-id",
  "communicationRecorded": true
}</pre>
                </div>

                <h4>Email Service</h4>
                <p>SendGrid (primary) or Resend (fallback)</p>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/generate-policy-documents</span>
                    <span class="auth-badge auth-required">Auth Required</span>
                </div>
                
                <h4>Description</h4>
                <p>Generate PDF policy documents from templates with variable substitution.</p>
                
                <h4>Required Roles</h4>
                <p><code>retail_agent</code> or <code>admin</code></p>
                
                <h4>Request Body</h4>
                <pre>{
  "policyId": "uuid",
  "documentTypes": ["policy_schedule", "terms_and_conditions"]
}</pre>

                <h4>Response</h4>
                <div class="success-box">
                    <span class="response-code code-200">200 OK</span>
                    <pre>{
  "success": true,
  "documents": [
    {
      "type": "policy_schedule",
      "url": "https://storage.url/policy-documents/...",
      "documentId": "uuid"
    },
    {
      "type": "terms_and_conditions",
      "url": "https://storage.url/policy-documents/...",
      "documentId": "uuid"
    }
  ]
}</pre>
                </div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/regenerate-communications</span>
                    <span class="auth-badge auth-required">Auth Required</span>
                </div>
                
                <h4>Description</h4>
                <p>Regenerate policy communications based on updated templates or policy changes.</p>
                
                <h4>Required Roles</h4>
                <p><code>admin</code> or <code>system_admin</code></p>
                
                <h4>Request Body</h4>
                <pre>{
  "policyId": "uuid",
  "communicationType": "policy_change",
  "reason": "Product upgrade"
}</pre>

                <h4>Response</h4>
                <div class="success-box">
                    <span class="response-code code-200">200 OK</span>
                    <pre>{
  "success": true,
  "communicationsGenerated": 3,
  "emailsSent": 1
}</pre>
                </div>
            </div>
        </div>

        <div id="utilities" class="section">
            <h2>6. Utility APIs</h2>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/retail-policy-lookup</span>
                    <span class="auth-badge auth-required">Auth Required</span>
                </div>
                
                <h4>Description</h4>
                <p>Advanced policy search by multiple criteria including email, phone, policy number, customer name.</p>
                
                <h4>Required Roles</h4>
                <p><code>retail_agent</code>, <code>claims_agent</code>, or <code>admin</code></p>
                
                <h4>Request Body</h4>
                <pre>{
  "searchType": "email" | "phone" | "policyNumber" | "name",
  "searchValue": "customer@example.com",
  "includeInactive": false
}</pre>

                <h4>Response</h4>
                <div class="success-box">
                    <span class="response-code code-200">200 OK</span>
                    <pre>{
  "success": true,
  "results": [
    {
      "policyId": "uuid",
      "policyNumber": "EW-000123",
      "customerName": "John Doe",
      "customerEmail": "john.doe@example.com",
      "productName": "Extended Warranty Plus",
      "status": "active",
      "startDate": "2025-01-01",
      "renewalDate": "2026-01-01"
    }
  ],
  "totalResults": 1
}</pre>
                </div>
            </div>
        </div>

        <div id="data-seeding" class="section">
            <h2>7. Data Seeding APIs</h2>

            <div class="warning-box">
                <strong>Warning:</strong> These endpoints are for development and testing only. Use with caution in production environments.
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/seed-demo-data</span>
                    <span class="auth-badge auth-required">Auth Required</span>
                </div>
                
                <h4>Description</h4>
                <p>Seed demonstration data for testing including users, policies, claims, and devices.</p>
                
                <h4>Required Roles</h4>
                <p><code>admin</code> or <code>system_admin</code></p>
                
                <h4>Request Body</h4>
                <pre>{
  "environment": "development",
  "includeUsers": true,
  "includePolicies": true,
  "includeClaims": true
}</pre>

                <h4>Response</h4>
                <div class="success-box">
                    <span class="response-code code-201">201 Created</span>
                    <pre>{
  "success": true,
  "summary": {
    "usersCreated": 10,
    "policiesCreated": 25,
    "claimsCreated": 15,
    "devicesCreated": 50
  }
}</pre>
                </div>
            </div>

            <div class="endpoint">
                <div class="endpoint-header">
                    <span class="method method-post">POST</span>
                    <span class="endpoint-path">/seed-retail-data</span>
                    <span class="auth-badge auth-none">No Auth</span>
                </div>
                
                <h4>Description</h4>
                <p>Seed retail portal demonstration data including retail agents, products, and sample sales data.</p>
                
                <h4>Required Roles</h4>
                <p>None (public endpoint for setup)</p>
                
                <h4>Request Body</h4>
                <p>No body required</p>

                <h4>Response</h4>
                <div class="success-box">
                    <span class="response-code code-201">201 Created</span>
                    <pre>{
  "success": true,
  "summary": {
    "agentsCreated": 5,
    "productsCreated": 10,
    "salesCreated": 20
  }
}</pre>
                </div>
            </div>
        </div>

        <div id="error-codes" class="section">
            <h2>8. Error Codes</h2>

            <h3>Common HTTP Status Codes</h3>
            <table>
                <thead>
                    <tr>
                        <th>Status Code</th>
                        <th>Meaning</th>
                        <th>Common Causes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="response-code code-200">200 OK</span></td>
                        <td>Success</td>
                        <td>Request completed successfully</td>
                    </tr>
                    <tr>
                        <td><span class="response-code code-201">201 Created</span></td>
                        <td>Resource Created</td>
                        <td>New resource created successfully</td>
                    </tr>
                    <tr>
                        <td><span class="response-code code-400">400 Bad Request</span></td>
                        <td>Invalid Request</td>
                        <td>Missing required fields, invalid JSON, validation errors</td>
                    </tr>
                    <tr>
                        <td><span class="response-code code-401">401 Unauthorized</span></td>
                        <td>Authentication Failed</td>
                        <td>Missing JWT token, expired token, invalid credentials</td>
                    </tr>
                    <tr>
                        <td><span class="response-code code-403">403 Forbidden</span></td>
                        <td>Access Denied</td>
                        <td>Insufficient permissions, role check failed</td>
                    </tr>
                    <tr>
                        <td><span class="response-code code-404">404 Not Found</span></td>
                        <td>Resource Not Found</td>
                        <td>Requested resource doesn't exist</td>
                    </tr>
                    <tr>
                        <td><span class="response-code code-500">500 Internal Server Error</span></td>
                        <td>Server Error</td>
                        <td>Database error, AI service error, unexpected exception</td>
                    </tr>
                </tbody>
            </table>

            <h3>Error Response Format</h3>
            <pre>{
  "error": true,
  "message": "Detailed error message",
  "code": "ERROR_CODE",
  "details": {
    // Additional context
  }
}</pre>

            <h3>Common Error Codes</h3>
            <table>
                <thead>
                    <tr>
                        <th>Error Code</th>
                        <th>Description</th>
                        <th>Resolution</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>AUTH_TOKEN_MISSING</code></td>
                        <td>No JWT token provided</td>
                        <td>Include Authorization header with Bearer token</td>
                    </tr>
                    <tr>
                        <td><code>AUTH_TOKEN_EXPIRED</code></td>
                        <td>JWT token has expired</td>
                        <td>Refresh token or re-authenticate</td>
                    </tr>
                    <tr>
                        <td><code>INSUFFICIENT_PERMISSIONS</code></td>
                        <td>User lacks required role</td>
                        <td>Contact admin to grant appropriate role</td>
                    </tr>
                    <tr>
                        <td><code>VALIDATION_ERROR</code></td>
                        <td>Request data validation failed</td>
                        <td>Check required fields and data types</td>
                    </tr>
                    <tr>
                        <td><code>RESOURCE_NOT_FOUND</code></td>
                        <td>Requested resource doesn't exist</td>
                        <td>Verify resource ID</td>
                    </tr>
                    <tr>
                        <td><code>AI_SERVICE_ERROR</code></td>
                        <td>AI analysis service failed</td>
                        <td>Retry request or contact support</td>
                    </tr>
                    <tr>
                        <td><code>EMAIL_DELIVERY_FAILED</code></td>
                        <td>Email could not be sent</td>
                        <td>Check email address and try again</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="metadata" style="margin-top: 60px; border-top: 2px solid #ecf0f1; padding-top: 20px;">
            <strong>Document Generated:</strong> November 26, 2025<br>
            <strong>API Version:</strong> v1<br>
            <strong>Last Updated:</strong> November 26, 2025<br>
            <strong>Support:</strong> Contact your system administrator
        </div>
    </div>
</body>
</html>